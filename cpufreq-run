#!/bin/bash

# Проверка запуска скрипта с правами администратора
if [ "$EUID" -ne 0 ]; then
    echo "Ошибка: запустите скрипт с правами администратора"
    echo "Перезапуск скрипта с правами администратора..."
    sudo bash "$0" "$@"
    exit $?
fi

# Определение списка опций
options=("Включить максимальную производительность" "Выключить максимальную производительность" "Вывести текущее состояние производительности" "Выход")
echo "Выберите опцию:"

# Цикл для вывода списка опций
select opt in "${options[@]}"
do
    case $opt in
        "Включить максимальную производительность")
            # Установка пакета cpufrequtils
            sudo apt-get update
            sudo apt-get install cpufrequtils -y

            # Установка производительности на максимум
            sudo cpufreq-set -r -g performance

            # Зафиксировать настройки после перезагрузки
            sudo sed -i '$i\cpufreq-set -r -g performance' /etc/rc.local

            echo "Максимальная производительность включена"
            ;;
        "Выключить максимальную производительность")
            # Возвращение производительности в исходное состояние
            sudo cpufreq-set -r -g ondemand

            # Удаление настроек из файла rc.local
            sudo sed -i '/cpufreq-set -r -g performance/d' /etc/rc.local

            echo "Максимальная производительность выключена"
            ;;
        "Вывести текущее состояние производительности")
            # Вывод текущего состояния производительности процессора
            echo "Текущее состояние производительности:"
            sudo cpufreq-info -o
            ;;
        "Выход")
            break
            ;;
        *) echo "Неверный выбор. Выберите опцию 1, 2, 3 или 4.";;
    esac
done

exit 0
